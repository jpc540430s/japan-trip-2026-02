<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>大阪之旅 2026</title>
    <!-- App 圖示設定 -->
    <link rel="apple-touch-icon" href="https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?q=80&w=200&h=200&fit=crop">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap');
        :root { --jp-red: #BC002D; --jp-bg: #FDFCF8; }
        body { font-family: 'Noto Sans JP', sans-serif; background-color: var(--jp-bg); color: #2D2D2D; font-size: 18px; }
        .card { background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 16px; overflow: hidden; border: 1px solid #F0EFEA; }
        .time-badge { background: #8C6454; color: white; padding: 2px 10px; border-radius: 8px; font-size: 14px; font-weight: bold; }
        .tab-content { display: none; padding-bottom: 100px; }
        .tab-content.active { display: block; }
        .nav-btn.active { color: var(--jp-red); border-top: 3px solid var(--jp-red); }
        .transport-card { background: #F0F4F8; border-left: 6px solid #4A90E2; padding: 12px; font-size: 15px; }
        .weather-hourly { display: none; }
        .expanded .weather-hourly { display: flex; }
    </style>
</head>
<body>

    <!-- Header & Day Switcher -->
    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b p-4 shadow-sm">
        <div class="flex justify-between items-center mb-4">
            <h1 class="text-2xl font-bold text-stone-800">2026 大阪・神戶</h1>
            <div id="current-temp" class="text-sm font-bold text-orange-600">8°C 晴天</div>
        </div>
        <div class="flex overflow-x-auto space-x-4 no-scrollbar pb-2" id="day-tabs">
            <!-- JS 動態生成 -->
        </div>
    </header>

    <!-- Main Content -->
    <main class="p-4">
        
        <!-- TAB 1: 行程 (Schedule) -->
        <div id="content-schedule" class="tab-content active">
            <!-- 天氣 Widget -->
            <div class="card p-4 bg-gradient-to-br from-blue-50 to-white" onclick="this.classList.toggle('expanded')">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-sm text-blue-600 font-bold">當日天氣 (點擊看每小時)</p>
                        <p class="text-xl font-bold" id="target-city">大阪市</p>
                    </div>
                    <i class="fas fa-sun text-3xl text-yellow-400"></i>
                </div>
                <div class="weather-hourly mt-4 flex space-x-4 overflow-x-auto text-center text-sm border-t pt-2">
                    <div><p>09:00</p><i class="fas fa-sun"></i><p>8°</p></div>
                    <div><p>12:00</p><i class="fas fa-sun"></i><p>12°</p></div>
                    <div><p>15:00</p><i class="fas fa-cloud-sun"></i><p>11°</p></div>
                    <div><p>18:00</p><i class="fas fa-moon"></i><p>7°</p></div>
                    <div><p>21:00</p><i class="fas fa-moon"></i><p>5°</p></div>
                </div>
            </div>

            <!-- 行程卡片容器 -->
            <div id="itinerary-list"></div>
        </div>

        <!-- TAB 2: 票券 (Tickets) -->
        <div id="content-tickets" class="tab-content">
            <h2 class="text-xl font-bold mb-4">我的票券</h2>
            <div id="ticket-list" class="grid grid-cols-1 gap-4"></div>
            <label class="mt-6 block bg-stone-800 text-white text-center py-4 rounded-xl cursor-pointer">
                <i class="fas fa-plus mr-2"></i>上傳票券照片
                <input type="file" class="hidden" accept="image/*" onchange="uploadImage(this, 'tickets')">
            </label>
        </div>

        <!-- TAB 3: 伴手禮 (Souvenirs) -->
        <div id="content-souvenirs" class="tab-content">
            <h2 class="text-xl font-bold mb-4">伴手禮備忘錄</h2>
            <div id="souvenir-list" class="grid grid-cols-2 gap-4"></div>
            <label class="mt-6 block bg-stone-800 text-white text-center py-4 rounded-xl cursor-pointer">
                <i class="fas fa-camera mr-2"></i>新增伴手禮照片
                <input type="file" class="hidden" accept="image/*" onchange="uploadImage(this, 'souvenirs')">
            </label>
        </div>

        <!-- TAB 4: 交通 (Transit) -->
        <div id="content-transit" class="tab-content">
            <div class="card p-4">
                <h2 class="font-bold mb-2">快速導覽地圖</h2>
                <a href="https://maps.app.goo.gl/gjzi4PHy3W2tBmfj6" class="text-blue-500 underline text-sm">點我打開 Google Maps 自訂地圖</a>
            </div>
            <div class="card p-4">
                <h2 class="font-bold mb-4">日本交通換乘查詢</h2>
                <div class="space-y-3">
                    <input type="text" id="start-node" placeholder="起點 (例如: 梅田)" class="w-full border p-3 rounded-lg text-sm">
                    <input type="text" id="end-node" placeholder="終點 (例如: 箕面)" class="w-full border p-3 rounded-lg text-sm">
                    <button onclick="searchTransit()" class="w-full bg-blue-600 text-white py-3 rounded-lg">Google 路線查詢</button>
                    <button onclick="window.open('https://www.jorudan.co.jp/english/','_blank')" class="w-full border border-blue-600 text-blue-600 py-3 rounded-lg">乘換案內 (Jorudan)</button>
                </div>
            </div>
        </div>

    </main>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around p-2 pb-6 z-50">
        <button onclick="switchTab('schedule')" class="nav-btn active flex flex-col items-center pt-2">
            <i class="fas fa-calendar-day text-xl"></i><span class="text-[10px] mt-1">行程</span>
        </button>
        <button onclick="switchTab('tickets')" class="nav-btn flex flex-col items-center pt-2">
            <i class="fas fa-ticket-alt text-xl"></i><span class="text-[10px] mt-1">票券</span>
        </button>
        <button onclick="switchTab('souvenirs')" class="nav-btn flex flex-col items-center pt-2">
            <i class="fas fa-gift text-xl"></i><span class="text-[10px] mt-1">伴手禮</span>
        </button>
        <button onclick="switchTab('transit')" class="nav-btn flex flex-col items-center pt-2">
            <i class="fas fa-subway text-xl"></i><span class="text-[10px] mt-1">交通</span>
        </button>
    </nav>

    <script>
        // --- 資料設定 ---
        const itineraryData = {
            1: [
                { time: "11:00", type: "move", title: "出門", desc: "前往桃園機場" },
                { time: "12:30", type: "spot", title: "桃園機場 T1", desc: "準備 Check-in" },
                { time: "15:40", type: "transport", title: "搭機 (CX/JX/CI...)", desc: "飛行時間約 2.5 小時" },
                { time: "19:20", type: "spot", title: "關西機場", desc: "入境與提領行李" },
                { time: "20:20", type: "transport", title: "搭乘利木津巴士", desc: "費用：約 ¥1,600 / 時間：60分", map: "https://www.google.com/maps/dir/Kansai+Airport/Hotel+New+Hankyu+Osaka+Annex" },
                { time: "21:20", type: "hotel", title: "新阪急酒店別館 Check-in", desc: "飯店休息" }
            ],
            2: [
                { time: "09:15", type: "spot", title: "大阪城天守閣", desc: "必看：黃金茶室、8樓展望台。攻略：周遊券免費。" },
                { time: "00:00", type: "transport", title: "步行 10 分鐘", desc: "往御座船搭乘處", map: "https://www.google.com/maps/dir/Osaka+Castle/Osaka+Castle+Gozabune" },
                { time: "10:00", type: "spot", title: "大阪城御座船", desc: "需先去劃位，周遊券免費。" },
                { time: "12:30", type: "food", title: "牛たんの檸檬 大阪本店", desc: "必吃：極厚切牛舌定食。需預約。", tag: "必吃美食" },
                { time: "14:00", type: "spot", title: "LOUTRE 大阪店 (水獺咖啡廳)", desc: "預約制，與水獺近距離接觸。" },
                { time: "15:00", type: "spot", title: "通天閣/新世界", desc: "必看：溜滑梯、展望台。攻略：晚上點燈後最漂亮。" },
                { time: "17:00", type: "spot", title: "HARUKAS 阿倍野展望台", desc: "看日落與夜景最佳點。攻略：B1可換周遊券折扣。" }
            ],
            3: [
                { time: "08:00", type: "move", title: "出門", desc: "往梅田站出發" },
                { time: "00:00", type: "transport", title: "御堂筋線 -> 北大阪急行", desc: "梅田站至箕面萱野站 (約30分)", map: "https://www.google.com/maps/dir/Umeda+Station/Minoh-kayano+Station" },
                { time: "08:45", type: "spot", title: "勝尾寺", desc: "攻略：滿山達摩，求勝運必去。必買：達摩御守。", tag: "必買伴手禮" },
                { time: "10:45", type: "spot", title: "箕面大瀑布", desc: "沿著森林步道散步，感受芬多精。" },
                { time: "13:00", type: "food", title: "箕面車站周邊午餐", desc: "必吃：炸楓葉(もみじの天ぷら)", tag: "必吃特色" },
                { time: "16:00", type: "spot", title: "吉伊卡哇LAND / KITTE大阪", desc: "購物時間。" }
            ],
            4: [
                { time: "08:30", type: "move", title: "出門", desc: "往有馬溫泉出發" },
                { time: "00:00", type: "transport", title: "阪急巴士 / 地鐵", desc: "直達巴士約 60 分 (¥1,400)", map: "https://www.google.com/maps/dir/Umeda/Arima+Onsen" },
                { time: "10:00", type: "spot", title: "有馬溫泉", desc: "攻略：金之湯、銀之湯。必買：碳酸煎餅。" },
                { time: "15:00", type: "spot", title: "神戶麵包超人館", desc: "必點：造型麵包。" },
                { time: "18:00", type: "spot", title: "神戶臨海樂園 umie", desc: "夜景與晚餐。" }
            ],
            5: [
                { time: "07:23", type: "move", title: "早起出門", desc: "往堺市方向" },
                { time: "08:10", type: "food", title: "客美多咖啡 堺鳳店", desc: "名古屋式早餐。" },
                { time: "09:00", type: "spot", title: "大鳥大社", desc: "必買：全日本瘋搶的「透明御守」。", tag: "必買攻略" },
                { time: "11:00", type: "spot", title: "富田林寺內町", desc: "江戶老街散策。" },
                { time: "19:00", type: "food", title: "玄品河豚 梅田東通", desc: "必吃：河豚套餐。", tag: "必吃美食" }
            ],
            6: [
                { time: "08:00", type: "food", title: "Cafe Sunshine", desc: "復古喫茶店厚鬆餅。" },
                { time: "09:00", type: "spot", title: "大阪今昔館", desc: "體驗江戶大阪街道。" },
                { time: "10:00", type: "spot", title: "天神橋筋商店街", desc: "全日最長商店街。" },
                { time: "16:00", type: "transport", title: "利木津巴士", desc: "往機場出發" },
                { time: "20:45", type: "move", title: "起飛", desc: "期待下次旅行" }
            ]
        };

        const days = ["2/17(一)", "2/18(二)", "2/19(三)", "2/20(四)", "2/21(五)", "2/22(六)"];
        let currentDay = 1;

        // --- 功能核心 ---

        function renderTabs() {
            const container = document.getElementById('day-tabs');
            days.forEach((day, index) => {
                const btn = document.createElement('button');
                btn.className = `tab-btn px-6 py-2 whitespace-nowrap rounded-full border ${index+1 === currentDay ? 'bg-stone-800 text-white' : 'bg-white text-stone-600'}`;
                btn.innerText = day;
                btn.onclick = () => { currentDay = index + 1; updateItinerary(); };
                container.appendChild(btn);
            });
        }

        function updateItinerary() {
            // 更新按鈕樣式
            document.querySelectorAll('.tab-btn').forEach((btn, i) => {
                btn.className = `tab-btn px-6 py-2 whitespace-nowrap rounded-full border ${i+1 === currentDay ? 'bg-stone-800 text-white' : 'bg-white text-stone-600'}`;
            });

            const list = document.getElementById('itinerary-list');
            list.innerHTML = "";
            const dayData = itineraryData[currentDay];

            dayData.forEach(item => {
                let cardHtml = "";
                if (item.type === 'transport') {
                    cardHtml = `
                        <div class="transport-card rounded-xl mb-4" onclick="window.open('${item.map || '#'}')">
                            <div class="flex justify-between items-center">
                                <p><i class="fas fa-train mr-2"></i><strong>交通：${item.title}</strong></p>
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </div>
                            <p class="text-sm mt-1 text-blue-800">${item.desc}</p>
                        </div>
                    `;
                } else {
                    const icon = item.type === 'food' ? 'utensils' : item.type === 'spot' ? 'camera' : 'clock';
                    const color = item.type === 'food' ? 'text-orange-500' : item.type === 'spot' ? 'text-teal-600' : 'text-stone-400';
                    cardHtml = `
                        <div class="card p-4">
                            <div class="flex items-center gap-3 mb-2">
                                <span class="time-badge">${item.time}</span>
                                <i class="fas fa-${icon} ${color}"></i>
                                <h3 class="font-bold text-lg">${item.title}</h3>
                            </div>
                            <p class="text-base text-stone-600 leading-relaxed">${item.desc}</p>
                            ${item.tag ? `<span class="inline-block mt-2 bg-red-100 text-red-600 text-xs px-2 py-1 rounded font-bold">${item.tag}</span>` : ""}
                        </div>
                    `;
                }
                list.innerHTML += cardHtml;
            });
            document.getElementById('target-city').innerText = currentDay === 4 ? "神戶市" : currentDay === 5 ? "堺市" : "大阪市";
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('content-' + tabId).classList.add('active');
            event.currentTarget.classList.add('active');
            window.scrollTo(0,0);
        }

        // --- 照片上傳與儲存 (LocalStorage) ---

        function uploadImage(input, type) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const name = prompt("請輸入照片名稱/說明：", "我的照片");
                if (name === null) return;

                const data = { id: Date.now(), src: e.target.result, name: name };
                let items = JSON.parse(localStorage.getItem(type) || "[]");
                items.push(data);
                localStorage.setItem(type, JSON.stringify(items));
                loadSavedItems(type);
            };
            reader.readAsDataURL(file);
        }

        function loadSavedItems(type) {
            const container = document.getElementById(type === 'tickets' ? 'ticket-list' : 'souvenir-list');
            container.innerHTML = "";
            let items = JSON.parse(localStorage.getItem(type) || "[]");
            
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = "card relative";
                div.innerHTML = `
                    <img src="${item.src}" class="w-full h-48 object-cover">
                    <div class="p-2 flex justify-between items-center">
                        <p class="text-sm font-bold truncate">${item.name}</p>
                        <button onclick="deleteItem('${type}', ${item.id})" class="text-red-400 text-xs">刪除</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function deleteItem(type, id) {
            if(!confirm("確定要刪除這張照片嗎？")) return;
            let items = JSON.parse(localStorage.getItem(type) || "[]");
            items = items.filter(i => i.id !== id);
            localStorage.setItem(type, JSON.stringify(items));
            loadSavedItems(type);
        }

        function searchTransit() {
            const start = document.getElementById('start-node').value;
            const end = document.getElementById('end-node').value;
            if(!start || !end) { alert("請輸入起點和終點"); return; }
            window.open(`https://www.google.com/maps/dir/${start}/${end}/`);
        }

        // 初始化
        renderTabs();
        updateItinerary();
        loadSavedItems('tickets');
        loadSavedItems('souvenirs');
    </script>
</body>
</html>
