 <!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OSAKA TRIP 2026</title>
    <link rel="apple-touch-icon" href="https://i.ibb.co/tpQr2PBh/images.jpg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #F8F9FA; color: #333; font-size: 18px; }
        .card { background: white; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 12px; border: 1px solid #EDEDED; overflow: hidden; }
        .time-badge { background: #444; color: white; padding: 3px 12px; border-radius: 8px; font-size: 15px; font-weight: bold; }
        .tab-content { display: none; padding-bottom: 120px; }
        .tab-content.active { display: block; }
        .nav-btn.active { color: #E91E63; border-top: 3px solid #E91E63; }
        .transit-card { background: #EBF2FF; border-left: 6px solid #3B82F6; padding: 15px; margin: 8px 0; border-radius: 15px; }
        #guide-modal, #album-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 1000; align-items: flex-end; }
        #image-viewer { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 2000; align-items: center; justify-content: center; padding: 20px; }
        .modal-body { background: white; width: 100%; border-radius: 25px 25px 0 0; padding: 25px; max-height: 90vh; overflow-y: auto; }
        .tag-red { background: #FFF0F0; color: #D32F2F; padding: 2px 8px; border-radius: 5px; font-size: 14px; font-weight: bold; margin-top: 5px; display: inline-block; }
    </style>
</head>
<body>

    <header class="sticky top-0 z-50 bg-white/90 backdrop-blur-md border-b p-4 text-center">
        <div class="flex justify-between items-center mb-4 text-left">
            <h1 class="text-xl font-black">OSAKA TRIP 2026</h1>
            <img src="https://i.ibb.co/tpQr2PBh/images.jpg" class="w-10 h-10 rounded-full object-cover">
        </div>
        <div class="flex overflow-x-auto space-x-2 no-scrollbar" id="day-tabs"></div>
    </header>

    <main class="p-4">
        <div id="content-schedule" class="tab-content active">
            <a id="weather-link" href="#" target="_blank" class="card p-5 bg-gradient-to-r from-sky-400 to-blue-500 text-white border-none mb-6 block">
                <div class="flex justify-between items-center mb-3"><span id="weather-city" class="font-bold text-lg">正在載入地點...</span><span class="text-xs bg-white/20 px-2 py-1 rounded">點擊看詳情</span></div>
                <div class="flex justify-between text-center" id="weather-grid"></div>
            </a>
            <div id="itinerary-list"></div>
        </div>

        <div id="content-tickets" class="tab-content">
            <h2 class="font-bold mb-4">我的票券 (點擊圖片放大)</h2>
            <div id="ticket-list" class="space-y-4"></div>
            <label class="mt-4 block bg-gray-800 text-white text-center py-4 rounded-xl font-bold"><i class="fas fa-plus mr-2"></i>上傳票券照片<input type="file" class="hidden" accept="image/*" onchange="uploadTicket(this)"></label>
        </div>

        <div id="content-souvenirs" class="tab-content">
            <div class="flex justify-between items-center mb-4">
                <h2 class="font-bold">伴手禮相簿</h2>
                <button onclick="createAlbum()" class="bg-pink-500 text-white px-4 py-2 rounded-lg text-sm font-bold">+ 新建相簿項目</button>
            </div>
            <div id="album-grid" class="grid grid-cols-2 gap-4"></div>
        </div>

        <div id="content-transit" class="tab-content">
            <a href="https://maps.app.goo.gl/gjzi4PHy3W2tBmfj6" target="_blank" class="card p-6 block bg-green-600 text-white mb-4 text-center font-bold">開啟 Google 自訂地圖</a>
            <a href="https://www.navitime.co.jp/zh-tw/transfer/" target="_blank" class="card p-6 block bg-blue-600 text-white text-center font-bold">Navitime 換乘查詢</a>
        </div>
    </main>

    <div id="guide-modal" onclick="closeModal()">
        <div class="modal-body" onclick="event.stopPropagation()">
            <h2 id="modal-title" class="text-2xl font-bold mb-4"></h2>
            <div id="modal-content" class="text-gray-600 space-y-4"></div>
            <button onclick="closeModal()" class="w-full mt-6 bg-gray-900 text-white py-4 rounded-xl">關閉</button>
        </div>
    </div>

    <div id="album-modal" class="fixed inset-0 bg-black z-[1001] hidden flex-col">
        <div class="p-4 bg-white flex justify-between items-center border-b">
            <h2 id="current-album-name" class="font-bold">相簿名稱</h2>
            <button onclick="closeAlbum()" class="text-2xl">&times;</button>
        </div>
        <div id="album-photos" class="flex-1 overflow-y-auto p-4 grid grid-cols-2 gap-3 bg-gray-50"></div>
        <div class="p-4 bg-white border-t">
            <label class="block bg-pink-500 text-white text-center py-4 rounded-xl font-bold cursor-pointer">+ 新增照片<input type="file" class="hidden" accept="image/*" id="album-photo-input"></label>
        </div>
    </div>

    <div id="image-viewer" onclick="closeViewer()">
        <img id="full-image" src="" class="max-w-full max-h-full object-contain">
        <button class="absolute top-8 right-8 text-white text-4xl">&times;</button>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around p-2 pb-6 z-50 shadow-lg">
        <button onclick="switchTab('schedule')" class="nav-btn active flex flex-col items-center"><i class="fas fa-calendar-alt text-xl"></i><span class="text-xs mt-1">行程</span></button>
        <button onclick="switchTab('tickets')" class="nav-btn flex flex-col items-center"><i class="fas fa-id-card text-xl"></i><span class="text-xs mt-1">票券</span></button>
        <button onclick="switchTab('souvenirs')" class="nav-btn flex flex-col items-center"><i class="fas fa-shopping-bag text-xl"></i><span class="text-xs mt-1">伴手禮</span></button>
        <button onclick="switchTab('transit')" class="nav-btn flex flex-col items-center"><i class="fas fa-route text-xl"></i><span class="text-xs mt-1">交通</span></button>
    </nav>

    <script>
        const transitDetails = {
            "大阪新阪急酒店別館->大阪城天守閣": "地鐵谷町線 (往八尾南) | 東梅田站月台 1 | 建議 08:45 班次 | 3 站 | 天滿橋站下車 | 約 15 分",
            "大阪城逛逛->牛たんの檸檬大阪本店": "地鐵中央線 (往コスモスクエア) | 谷町四丁目站月台 2 | 2 站 | 本町站轉御堂筋線月台 1 | 全程約 25 分",
            "牛たんの檸檬大阪本店->LOUTRE 大阪店": "心齋橋站步行區域 | 往大丸百貨方向 | 約 10 分",
            "LOUTRE 大阪店->通天閣/四大天王/新世界商店街": "地鐵御堂筋線 (往中百舌鳥) | 心齋橋站月台 1 | 建議 14:45 班次 | 2 站 | 動物園前站下車 | 約 15 分",
            "通天閣/四大天王/新世界商店街->HARUKAS 阿倍野展望台": "地鐵御堂筋線 | 動物園前站月台 1 | 1 站 | 天王寺站下車 | 約 8 分",
            "大阪新阪急酒店別館->勝尾寺": "地鐵御堂筋線 (往箕面萱野) | 梅田站月台 1 | 建議 08:10 班次 | 終點站下車 | 轉計程車 15 分 | 全程 50 分",
            "勝尾寺->大瀑布": "山區步行路徑 | 下坡為主 | 約 25 分",
            "箕面車站吃飯->梅田阪急逛街": "阪急箕面線 | 箕面站月台 1 | 石橋阪大前轉寶塚線月台 4 | 建議 14:40 班次 | 全程約 35 分",
            "大阪新阪急酒店別館->有馬溫泉(有馬案内所)": "阪急梅田高速巴士總站 | 月台 1 | 建議預約 08:50 班次 | 直達 | 全程 60 分",
            "離開有馬->麵包超人": "神戶電鐵有馬線 | 有馬溫泉站月台 1 | 谷上站轉北神線至新神戶 | 轉西神山手線至港區 | 全程約 50 分",
            "大阪新阪急酒店別館->早餐：客美多咖啡 堺鳳店": "JR 大阪站月台 1 (關空快速) | 建議 07:35 班次 | 7 站 | 鳳站下車 | 約 45 分",
            "堺市 大鳥大社：透明御守->富田林寺內町": "JR 鳳站往天王寺 | 近鐵阿部野橋站轉長野線 | 建議 10:20 班次 | 月台 3 | 全程 60 分",
            "富田林寺內町->梅田": "近鐵河內松原轉急行 | 天王寺站轉御堂筋線月台 2 | 全程約 50 分",
            "大阪新阪急酒店別館->Cafe Sunshine": "地鐵谷町線 | 東梅田站月台 1 | 步行 5 分即抵達 | 全程約 10 分",
            "今昔館->天神筋商店街": "電梯下至 1 樓即抵達商店街入口 | 步行 2 分"
        };

        const guideBook = {
            "大阪城天守閣": { tip: "持周遊券免費。", info: "1583年興建，8樓展望台俯瞰大阪。展示豐臣家歷史。" },
            "牛たんの檸檬大阪本店": { tip: "必吃厚切牛舌。", info: "極軟嫩熟成牛舌，目前大阪最夯排隊名店之一。" },
            "勝尾寺": { tip: "買達摩御守。", info: "1300年歷史勝運古寺，山中滿是信徒還願的達摩。" },
            "大鳥大社": { tip: "限量透明御守。", info: "近期社群爆紅，透明設計能映照背景风景，開運必買。" },
            "有馬溫泉(有馬案内所)": { tip: "金之湯銀之湯。", info: "日本三大古泉，金泉含鐵鹽對關節極佳。" },
            "天神筋商店街": { tip: "日本最長商店街。", info: "全長2.6公里，集結各式在地美食與平價雜貨。" },
            "玄品 大阪 梅田東通": { tip: "必吃河豚火鍋粥。", info: "職人處理虎河豚，最後將湯頭煮成粥是美味靈魂。" }
        };

        const weatherData = {
            1: { city: "大阪 (KIX)", temps: [8, 12, 11, 9, 7], icon: "fa-cloud-sun" },
            2: { city: "大阪 (市區)", temps: [7, 13, 13, 10, 8], icon: "fa-sun" },
            3: { city: "箕面 (山區)", temps: [4, 9, 8, 5, 3], icon: "fa-cloud" },
            4: { city: "神戶/有馬", temps: [3, 8, 7, 4, 2], icon: "fa-snowflake" },
            5: { city: "堺市/富田林", temps: [6, 12, 11, 8, 6], icon: "fa-sun" },
            6: { city: "大阪 (市區)", temps: [8, 14, 13, 10, 8], icon: "fa-sun" }
        };

        const itinerary = {
            1: [ { time: "11:00", title: "出門", type: "move" }, { time: "12:30", title: "桃園機場 T1 Airasia", type: "spot" }, { time: "15:40", title: "TPE 起飛", type: "flight" }, { time: "19:20", title: "KIX 降落", type: "flight" }, { time: "20:20", title: "關西機場離開搭利木津巴士", type: "bus" }, { time: "21:20", title: "check in大阪新阪急酒店別館", type: "hotel" } ],
            2: [ { time: "08:30", title: "大阪新阪急酒店別館", type: "move" }, { time: "09:15", title: "大阪城天守閣", type: "spot" }, { time: "10:00", title: "大阪城御座船", type: "spot" }, { time: "10:30", title: "大阪城逛逛", type: "spot" }, { time: "12:30", title: "牛たんの檸檬大阪本店", type: "food" }, { time: "14:00", title: "LOUTRE 大阪店", type: "spot" }, { time: "15:00", title: "通天閣/四大天王/新世界商店街", type: "spot" }, { time: "17:00", title: "HARUKAS 阿倍野展望台", type: "spot" }, { time: "17:30", title: "備案：大阪高島屋", type: "spot" }, { time: "21:00", title: "回飯店：大阪新阪急酒店別館", type: "hotel" } ],
            3: [ { time: "08:00", title: "大阪新阪急酒店別館", type: "move" }, { time: "08:45", title: "勝尾寺", type: "spot" }, { time: "10:45", title: "大瀑布", type: "spot" }, { time: "11:30", title: "瀧安寺", type: "spot" }, { time: "13:00", title: "炸楓葉、足湯、案内所", type: "food" }, { time: "13:30", title: "箕面車站吃飯", type: "food" }, { time: "15:00", title: "梅田阪急逛街", type: "spot" }, { time: "16:00", title: "吉伊卡哇LAND 大阪梅田店", type: "spot" }, { time: "17:00", title: "KITTE大阪", type: "spot" }, { time: "18:00", title: "4F 豊亨 吃飯", type: "food" }, { time: "21:00", title: "回飯店：大阪新阪急酒店別館", type: "hotel" } ],
            4: [ { time: "08:30", title: "大阪新阪急酒店別館", type: "move" }, { time: "10:00", title: "有馬溫泉(有馬案内所)", type: "spot" }, { time: "12:00", title: "有馬午餐", type: "food" }, { time: "15:00", title: "麵包超人", type: "spot" }, { time: "18:00", title: "神戶臨海樂園 umie", type: "spot" }, { time: "20:00", title: "回飯店：大阪新阪急酒店別館", type: "hotel" } ],
            5: [ { time: "07:23", title: "大阪新阪急酒店別館", type: "move" }, { time: "08:10", title: "早餐：客美多咖啡 堺鳳店", type: "food" }, { time: "09:00", title: "堺市 大鳥大社：透明御守", type: "spot" }, { time: "11:00", title: "富田林寺內町", type: "spot" }, { time: "12:00", title: "麺坊七福 寺内町店|古民家カフェゆうぷく", type: "food" }, { time: "16:30", title: "梅田", type: "spot" }, { time: "19:00", title: "玄品 大阪 梅田東通", type: "food" }, { time: "21:00", title: "回飯店：大阪新阪急酒店別館", type: "hotel" } ],
            6: [ { time: "08:00", title: "大阪新阪急酒店別館", type: "move" }, { time: "08:15", title: "Cafe Sunshine", type: "food" }, { time: "09:00", title: "今昔館", type: "spot" }, { time: "10:00", title: "天神筋商店街", type: "spot" }, { time: "11:00", title: "天滿宮", type: "spot" }, { time: "12:00", title: "午餐", type: "food" }, { time: "16:00", title: "大阪新阪急酒店別館離開搭利木津巴士", type: "bus" }, { time: "17:00", title: "關西機場", type: "spot" }, { time: "20:45", title: "KIX 起飛", type: "flight" }, { time: "23:05", title: "降落", type: "flight" } ]
        };

        let currentDay = 1;
        function viewImage(s) { document.getElementById('full-image').src = s; document.getElementById('image-viewer').style.display = 'flex'; }
        function closeViewer() { document.getElementById('image-viewer').style.display = 'none'; }
        
        function updateUI() {
            const tabs = ["2/17(一)", "2/18(二)", "2/19(三)", "2/20(四)", "2/21(五)", "2/22(六)"];
            const container = document.getElementById('day-tabs'); container.innerHTML = "";
            tabs.forEach((day, i) => {
                const btn = document.createElement('button');
                btn.className = `px-5 py-2 whitespace-nowrap rounded-full border-2 font-bold ${i+1 === currentDay ? 'bg-black text-white' : 'bg-white text-gray-500'}`;
                btn.innerText = day; btn.onclick = () => { currentDay = i + 1; updateUI(); }; container.appendChild(btn);
            });

            const w = weatherData[currentDay];
            document.getElementById('weather-city').innerText = w.city;
            document.getElementById('weather-link').href = "https://translate.google.com/translate?sl=ja&tl=zh-TW&u=https://weathernews.jp/onebox/34.69/135.50/";
            const grid = document.getElementById('weather-grid'); grid.innerHTML = "";
            const hours = ["08:00", "12:00", "15:00", "18:00", "21:00"];
            w.temps.forEach((t, i) => { grid.innerHTML += `<div class="px-2"><p class="text-[10px] opacity-70">${hours[i]}</p><i class="fas ${w.icon} my-1"></i><p class="font-bold text-sm">${t}°</p></div>`; });

            const list = document.getElementById('itinerary-list'); list.innerHTML = "";
            const items = itinerary[currentDay];
            items.forEach((item, idx) => {
                const guide = guideBook[item.title];
                list.innerHTML += `<div class="card p-5" onclick="openModal('${item.title}')">
                    <div class="flex items-center gap-3"><span class="time-badge">${item.time}</span><h3 class="font-bold text-lg">${item.title}</h3></div>
                    ${guide ? `<p class="tag-red"><i class="fas fa-lightbulb mr-1"></i> ${guide.tip}</p>` : ''}
                </div>`;

                if (idx < items.length - 1 && item.type !== 'flight') {
                    const next = items[idx + 1]; let link = `https://www.google.com/maps/dir/${item.title}/${next.title}/`;
                    const routeKey = `${item.title}->${next.title}`; let summary = transitDetails[routeKey] || `導航往 ${next.title.substring(0,8)}`;
                    if ((currentDay === 1 && idx >= 4) || (currentDay === 6 && idx >= 6)) {
                        link = "https://www.kate.co.jp/tcn/timetable/detail/UM"; summary = "利木津巴士：直達關西機場/梅田 (點此查看時刻表)";
                    }
                    list.innerHTML += `<a href="${link}" target="_blank" class="transit-card block">
                        <div class="flex justify-between items-start text-blue-800"><i class="fas fa-subway mt-1 mr-3 text-lg"></i><div class="flex-1"><p class="text-sm font-black leading-tight">${summary}</p></div><i class="fas fa-external-link-alt text-xs ml-2 opacity-50"></i></div>
                    </a>`;
                }
            });
        }

        let currentAlbumId = null;
        function createAlbum() {
            const name = prompt("請輸入相簿名稱："); if (!name) return;
            let albums = JSON.parse(localStorage.getItem('albums') || "[]");
            albums.push({ id: Date.now(), name: name, photos: [] }); localStorage.setItem('albums', JSON.stringify(albums)); renderAlbumGrid();
        }
        function renderAlbumGrid() {
            const grid = document.getElementById('album-grid'); grid.innerHTML = "";
            let albums = JSON.parse(localStorage.getItem('albums') || "[]");
            albums.forEach(album => {
                const cover = album.photos.length > 0 ? album.photos[0].src : 'https://placehold.co/200x200?text=Empty';
                grid.innerHTML += `<div class="card relative" onclick="openAlbum(${album.id})"><img src="${cover}" class="w-full h-32 object-cover"><div class="p-2 bg-white text-xs font-bold truncate">${album.name} (${album.photos.length})</div><button onclick="deleteAlbum(event, ${album.id})" class="absolute top-1 right-1 bg-black/50 text-white w-6 h-6 rounded-full text-xs">×</button></div>`;
            });
        }
        function openAlbum(id) {
            currentAlbumId = id; let albums = JSON.parse(localStorage.getItem('albums')); const album = albums.find(a => a.id === id);
            document.getElementById('current-album-name').innerText = album.name; renderAlbumPhotos(); document.getElementById('album-modal').style.display = 'flex';
        }
        function renderAlbumPhotos() {
            const container = document.getElementById('album-photos'); container.innerHTML = "";
            let albums = JSON.parse(localStorage.getItem('albums')); const album = albums.find(a => a.id === currentAlbumId);
            album.photos.forEach((photo, idx) => {
                container.innerHTML += `<div class="card bg-white"><img src="${photo.src}" class="w-full h-40 object-cover" onclick="viewImage('${photo.src}')"><div class="p-2 flex justify-between items-center text-xs"><span class="truncate font-bold">${photo.name}</span><button onclick="deletePhoto(${idx})" class="text-red-500"><i class="fas fa-trash"></i></button></div></div>`;
            });
        }
        document.getElementById('album-photo-input').onchange = function(e) {
            const file = e.target.files[0]; if (!file) return;
            const reader = new FileReader(); reader.onload = function(event) {
                const photoName = prompt("請命名照片："); if (!photoName) return;
                let albums = JSON.parse(localStorage.getItem('albums')); const album = albums.find(a => a.id === currentAlbumId);
                album.photos.push({ src: event.target.result, name: photoName }); localStorage.setItem('albums', JSON.stringify(albums)); renderAlbumPhotos(); renderAlbumGrid();
            }; reader.readAsDataURL(file);
        };
        function closeAlbum() { document.getElementById('album-modal').style.display = 'none'; }
        function deleteAlbum(e, id) { e.stopPropagation(); if(!confirm("確定刪除？")) return; let albums = JSON.parse(localStorage.getItem('albums')).filter(a => a.id !== id); localStorage.setItem('albums', JSON.stringify(albums)); renderAlbumGrid(); }
        function deletePhoto(idx) { if(!confirm("確定刪除？")) return; let albums = JSON.parse(localStorage.getItem('albums')); const album = albums.find(a => a.id === currentAlbumId); album.photos.splice(idx, 1); localStorage.setItem('albums', JSON.stringify(albums)); renderAlbumPhotos(); renderAlbumGrid(); }

        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('content-' + id).classList.add('active'); event.currentTarget.classList.add('active');
            if(id === 'souvenirs') renderAlbumGrid(); if(id === 'tickets') renderTickets();
        }
        function openModal(t) { const g = guideBook[t]; if(!g) return; document.getElementById('modal-title').innerText = t; document.getElementById('modal-content').innerHTML = `<p>${g.info}</p>`; document.getElementById('guide-modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('guide-modal').style.display = 'none'; }
        
        function uploadTicket(input) {
            const file = input.files[0]; if(!file) return;
            const reader = new FileReader(); reader.onload = function(e) {
                const name = prompt("命名票券："); if(!name) return;
                let t = JSON.parse(localStorage.getItem('tickets') || "[]");
                t.push({ id: Date.now(), src: e.target.result, name: name }); localStorage.setItem('tickets', JSON.stringify(t)); renderTickets();
            }; reader.readAsDataURL(file);
        }
        function renderTickets() {
            const list = document.getElementById('ticket-list'); list.innerHTML = "";
            let t = JSON.parse(localStorage.getItem('tickets') || "[]");
            t.forEach(tk => {
                list.innerHTML += `<div class="card p-3 flex gap-3 items-center"><img src="${tk.src}" class="w-16 h-16 object-cover rounded cursor-pointer" onclick="viewImage('${tk.src}')"><span class="flex-1 font-bold">${tk.name}</span><button onclick="deleteTicket(${tk.id})" class="text-red-500">×</button></div>`;
            });
        }
        function deleteTicket(id) { let t = JSON.parse(localStorage.getItem('tickets')).filter(tk => tk.id !== id); localStorage.setItem('tickets', JSON.stringify(t)); renderTickets(); }

        updateUI(); renderTickets();
    </script>
</body>
</html>
